# Проект классификации цветов

## Описание проекта

Проект представляет собой систему для автоматической классификации изображений цветов на 5 категорий: Лилия (Lilly), Лотос (Lotus), Орхидея (Orchid), Подсолнух (Sunflower) и Тюльпан (Tulip). Решение включает в себя:

- **Модель машинного обучения** для классификации изображений
- **REST API сервер** для обработки запросов
- **Интерактивный веб-интерфейс** с возможностью:
  - Загрузки изображений
  - Рисования цветов на холсте
  - Визуализации результатов классификации

Система предназначена для использования в мобильных приложениях, веб-сервисах и образовательных целях.

## Используемый датасет

Для обучения моделей был собран специализированный датасет с следующими характеристиками:

- **Объем данных**: 5,200 изображений
- **Распределение по классам**:
  - Lilly: 1,050 изображений
  - Lotus: 1,100 изображений
  - Orchid: 1,000 изображений
  - Sunflower: 1,050 изображений
  - Tulip: 1,000 изображений

- **Разрешение**: 256×256 пикселей
- **Разнообразие**: изображения содержат цветы в различных условиях (освещение, фон, ракурс)
- **Источник**: компиляция из открытых датасетов и собранных вручную изображений

![Примеры изображений из датасета](images/example.jpg)

## Сравнение моделей

В проекте были протестированы 4 различные архитектуры нейронных сетей:

1. **VGG-Like** - модифицированная версия VGG16 с уменьшенным количеством параметров
2. **Flower Model** - специализированная архитектура для классификации цветов
3. **Base CNN** - базовая сверточная сеть с 3 блоками сверток
4. **Best Model** - экспериментальная архитектура с механизмом внимания

### Результаты сравнения моделей

| Модель       | Accuracy | Precision | Recall | F1-Score | Время предсказания (мс) |
|--------------|----------|-----------|--------|----------|-------------------------|
| VGG-Like     | 0.9236   | 0.9110    | 0.9223 | 0.9166   | 15.40                  |
| Flower Model | 0.8107   | 0.7966    | 0.8083 | 0.8024   | 24.31                  |
| Base CNN     | 0.6801   | 0.6544    | 0.6538 | 0.6541   | 13.23                  |
| Best Model   | 0.2201   | 0.1981    | 0.2170 | 0.2071   | 23.45                  |

### Анализ результатов

1. **VGG-Like модель** продемонстрировала наилучшие показатели:
   - Высокая точность (Accuracy = 92.36%)
   - Сбалансированные Precision и Recall
   - Оптимальное время предсказания (15.4 мс)
   - Рекомендована для production-решений

2. **Flower Model** показала хорошие результаты:
   - Accuracy 81.07%
   - Немного большее время обработки
   - Подходит для специализированных задач

3. **Base CNN** - самая быстрая, но менее точная:
   - Лучшее время предсказания (13.23 мс)
   - Accuracy 68.01%
   - Идеальна для мобильных устройств

4. **Best Model** показала неожиданно низкие результаты, что требует дополнительного исследования возможных причин:
   - Проблемы с обучением
   - Переобучение
   - Неправильная архитектура

![Сравнение метрик моделей](images/metrics.png)

## Визуализации результатов

### Матрица ошибок лучшей модели (VGG-Like)
![Матрица ошибок](images/matrix.png)

### Примеры предсказаний
![Правильные и ошибочные предсказания](images/predict.png)

## Локальное развертывание

### Требования
- Python 3.8+
- NVIDIA GPU (рекомендуется) с поддержкой CUDA 11.0+
- 8GB+ оперативной памяти

### Установка
1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/flower-classification.git
cd flower-classification
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Подготовьте модель:
```bash
python prepare_models.py
```

### Запуск системы
1. Запустите API сервер:
```bash
uvicorn api.main:app --host 0.0.0.0 --port 8000
```

2. Запустите веб-интерфейс:
```bash
streamlit run app.py
```

3. Откройте в браузере:
```
http://localhost:8501
```

## Развернутые сервисы

- **API**: [https://flower-classification-api.onrender.com](https://flower-classification-api.onrender.com)
- **Веб-интерфейс**: [https://flower-classification.streamlit.app](https://flower-classification.streamlit.app)

## Примеры использования API

### Python
```python
import requests
from PIL import Image

url = "https://flower-classification-api.onrender.com/predict/"
image = Image.open("test_flower.jpg")

response = requests.post(url, files={"file": image})
print(response.json())
```

### cURL
```bash
curl -X POST -F "file=@test_flower.jpg" https://flower-classification-api.onrender.com/predict/
```

### Пример ответа
```json
{
  "predicted_class": "Orchid",
  "confidence": 0.9236,
  "probabilities": {
    "Lilly": 0.021,
    "Lotus": 0.015,
    "Orchid": 0.924,
    "Sunflower": 0.025,
    "Tulip": 0.015
  },
  "model_version": "vgg-like-v1.2",
  "inference_time_ms": 15.4
}
```

## Лицензия

Проект распространяется под лицензией MIT. Полный текст лицензии доступен в файле [LICENSE](LICENSE).
